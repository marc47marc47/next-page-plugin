# Anime Next - é–‹ç™¼æ–‡ä»¶

## å°ˆæ¡ˆæ¦‚è¿°

### å°ˆæ¡ˆåç¨±
**Anime Next** - æ™ºèƒ½éµç›¤å°èˆªæ“´å……åŠŸèƒ½

### ç‰ˆæœ¬è³‡è¨Š
- **ç•¶å‰ç‰ˆæœ¬**: v1.0.0
- **æœ€å¾Œæ›´æ–°**: 2024-11-07
- **Manifest ç‰ˆæœ¬**: Chrome Extension Manifest V3

### å°ˆæ¡ˆç›®æ¨™
å»ºç«‹ä¸€å€‹å…¨åŠŸèƒ½çš„ Chrome/Edge ç€è¦½å™¨æ“´å……åŠŸèƒ½ï¼Œé€éæ™ºèƒ½çš„å››å±¤å°èˆªç­–ç•¥ï¼Œè®“ä½¿ç”¨è€…èƒ½å¤ åœ¨ä»»ä½•é¡å‹çš„åˆ†é ç¶²ç«™ä¸Šä½¿ç”¨éµç›¤æ–¹å‘éµé€²è¡Œå°èˆªï¼Œå¤§å¹…æå‡ç€è¦½é«”é©—ã€‚

### æ ¸å¿ƒç‰¹è‰²
- ğŸ¯ å››å±¤æ™ºèƒ½å°èˆªç­–ç•¥ï¼Œé©æ‡‰æ‰€æœ‰é¡å‹çš„åˆ†é ç¶²ç«™
- ğŸŒ å¤šèªè¨€æ”¯æ´ï¼ˆè‹±ã€ä¸­ã€æ—¥ã€éŸ“ã€è¥¿ã€æ³•ã€å¾·ï¼‰
- âš¡ é«˜æ•ˆèƒ½ï¼Œä½å»¶é²ï¼ˆ< 100msï¼‰
- ğŸ¨ å¯é¸çš„è¦–è¦ºå›é¥‹æ•ˆæœ
- ğŸ”§ å®Œæ•´çš„è‡ªè¨‚é…ç½®é¸é …
- ğŸ“¦ è¼•é‡ç´šè¨­è¨ˆï¼Œä¸å½±éŸ¿ç¶²é æ•ˆèƒ½

---

## æŠ€è¡“æ¶æ§‹

### å››å±¤å°èˆªç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ¶æŒ‰ä¸‹æ–¹å‘éµ (â† æˆ– â†’)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 1 å±¤ï¼šæŒ‰éˆ•å°èˆª (Button Navigation)    â”‚
â”‚  â€¢ é€é ID æŸ¥æ‰¾æŒ‰éˆ•                       â”‚
â”‚  â€¢ é€é Class æŸ¥æ‰¾æŒ‰éˆ•                    â”‚
â”‚  â€¢ é€é Data å±¬æ€§æŸ¥æ‰¾                     â”‚
â”‚  â€¢ æ”¯æ´è‡ªè¨‚æŒ‰éˆ• ID                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“ æ‰¾ä¸åˆ°æŒ‰éˆ•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 2 å±¤ï¼šURL åƒæ•¸å°èˆª                    â”‚
â”‚  â€¢ è®€å– URL ä¸­çš„é ç¢¼åƒæ•¸                  â”‚
â”‚  â€¢ è¨ˆç®—ç›®æ¨™é ç¢¼ (Â±1)                      â”‚
â”‚  â€¢ æ§‹å»ºæ–° URL ä¸¦å°èˆª                      â”‚
â”‚  â€¢ æ”¯æ´è‡ªè¨‚åƒæ•¸åç¨±                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“ URL æ²’æœ‰é ç¢¼åƒæ•¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 3 å±¤ï¼šæ™ºèƒ½é€£çµæƒæ                    â”‚
â”‚  â€¢ æƒææ‰€æœ‰ <a> æ¨™ç±¤                      â”‚
â”‚  â€¢ æå–åŒ…å«é ç¢¼çš„é€£çµ                     â”‚
â”‚  â€¢ æ¨æ–·ç•¶å‰é ç¢¼                           â”‚
â”‚  â€¢ å°èˆªåˆ°ç›®æ¨™é ç¢¼çš„é€£çµ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“ æ²’æœ‰åˆ†é é€£çµ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 4 å±¤ï¼šLoad More æŒ‰éˆ•æª¢æ¸¬              â”‚
â”‚  â€¢ æƒæ button å’Œ link å…ƒç´                â”‚
â”‚  â€¢ å¤šèªè¨€é—œéµå­—åŒ¹é…                       â”‚
â”‚  â€¢ Class/ID æ¨¡å¼åŒ¹é…                      â”‚
â”‚  â€¢ è‡ªå‹•é»æ“Š Load More æŒ‰éˆ•                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
         âœ… å°èˆªæˆåŠŸ or âŒ æ‰€æœ‰æ–¹æ³•å¤±æ•—
```

### æŠ€è¡“æ£§

- **é–‹ç™¼èªè¨€**: JavaScript (ES6+)
- **æ“´å……åŠŸèƒ½æ¨™æº–**: Chrome Extension Manifest V3
- **ä¾è³´**: ç„¡å¤–éƒ¨ä¾è³´ï¼ˆç´” Vanilla JavaScriptï¼‰
- **æœ€ä½ç€è¦½å™¨ç‰ˆæœ¬**:
  - Chrome: 88+
  - Edge: 88+

### æ ¸å¿ƒçµ„ä»¶æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser (Chrome/Edge)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Extension Framework (Manifest V3)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚                 â”‚                   â”‚
â”‚  [1]   â”‚   [2]          â”‚   [3]             â”‚
â”‚ Back-  â”‚ Content        â”‚ Popup             â”‚
â”‚ ground â”‚ Script         â”‚ UI                â”‚
â”‚ â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€       â”‚ â”€â”€â”€â”€â”€             â”‚
â”‚ ç‹€æ…‹   â”‚ æ ¸å¿ƒé‚è¼¯       â”‚ è¨­å®šä»‹é¢          â”‚
â”‚ ç®¡ç†   â”‚ å››å±¤å°èˆª       â”‚ ä½¿ç”¨è€…é…ç½®        â”‚
â”‚        â”‚ äº‹ä»¶è™•ç†       â”‚                   â”‚
â”‚        â”‚                 â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chrome Storage API (åŒæ­¥è¨­å®š)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æª”æ¡ˆçµæ§‹

```
anime-next/
â”œâ”€â”€ manifest.json                  # æ“´å……åŠŸèƒ½é…ç½®æª”æ¡ˆ
â”œâ”€â”€ content.js                    # å…§å®¹è…³æœ¬ï¼ˆæ ¸å¿ƒé‚è¼¯ï¼Œ900+ è¡Œï¼‰
â”œâ”€â”€ background.js                 # èƒŒæ™¯æœå‹™è…³æœ¬
â”œâ”€â”€ popup.html                    # å½ˆå‡ºè¦–çª— UI
â”œâ”€â”€ popup.js                      # å½ˆå‡ºè¦–çª—é‚è¼¯ï¼ˆ260+ è¡Œï¼‰
â”‚
â”œâ”€â”€ icons/                        # åœ–ç¤ºè³‡æº
â”‚   â”œâ”€â”€ icon16.png
â”‚   â”œâ”€â”€ icon48.png
â”‚   â””â”€â”€ icon128.png
â”‚
â”œâ”€â”€ styles/                       # æ¨£å¼æª”æ¡ˆ
â”‚   â””â”€â”€ content.css              # å…§å®¹è…³æœ¬æ¨£å¼ï¼ˆè¦–è¦ºå›é¥‹ï¼‰
â”‚
â”œâ”€â”€ test/                         # æ¸¬è©¦é é¢
â”‚   â”œâ”€â”€ test-page.html           # åŸºæœ¬æŒ‰éˆ•å°èˆªæ¸¬è©¦
â”‚   â”œâ”€â”€ custom-id-test.html      # è‡ªè¨‚ ID æ¸¬è©¦
â”‚   â”œâ”€â”€ url-navigation-test.html # URL åƒæ•¸å°èˆªæ¸¬è©¦
â”‚   â”œâ”€â”€ href-scan-test.html      # é€£çµæƒææ¸¬è©¦
â”‚   â””â”€â”€ load-more-test.html      # Load More æª¢æ¸¬æ¸¬è©¦
â”‚
â”œâ”€â”€ docs/                         # æ–‡ä»¶è³‡æ–™å¤¾
â”‚   â”œâ”€â”€ README.md                # å°ˆæ¡ˆèªªæ˜
â”‚   â”œâ”€â”€ DEVELOP.md               # é–‹ç™¼æ–‡ä»¶ï¼ˆæœ¬æª”æ¡ˆï¼‰
â”‚   â”œâ”€â”€ INSTALL.md               # å®‰è£æŒ‡å—
â”‚   â”œâ”€â”€ TESTING.md               # æ¸¬è©¦æŒ‡å—
â”‚   â”œâ”€â”€ COMPATIBILITY.md         # ç›¸å®¹æ€§èªªæ˜
â”‚   â”œâ”€â”€ CUSTOM-ID-GUIDE.md       # è‡ªè¨‚ ID æŒ‡å—
â”‚   â”œâ”€â”€ URL-NAVIGATION-GUIDE.md  # URL å°èˆªæŒ‡å—
â”‚   â”œâ”€â”€ HREF-SCAN-GUIDE.md       # é€£çµæƒææŒ‡å—
â”‚   â”œâ”€â”€ LOAD-MORE-GUIDE.md       # Load More æŒ‡å—
â”‚   â””â”€â”€ NAVIGATION-STRATEGIES.md # å°èˆªç­–ç•¥ç¸½è¦½
â”‚
â”œâ”€â”€ Edgeè¼‰å…¥èªªæ˜.txt             # Edge ç€è¦½å™¨è¼‰å…¥èªªæ˜
â”œâ”€â”€ å¿«é€Ÿå®‰è£æŒ‡å—.txt             # å¿«é€Ÿå®‰è£æŒ‡å—
â””â”€â”€ TODO.md                      # é–‹ç™¼å¾…è¾¦äº‹é …
```

---

## æ ¸å¿ƒæ¨¡çµ„è©³è§£

### 1. Content Script (content.js)

**è·è²¬**: æ³¨å…¥åˆ°æ‰€æœ‰ç¶²é ï¼Œè™•ç†éµç›¤äº‹ä»¶å’ŒåŸ·è¡Œå°èˆªé‚è¼¯

#### ä¸»è¦åŠŸèƒ½æ¨¡çµ„

```javascript
// 1. é…ç½®ç®¡ç†
const CONFIG = {
  BUTTON_SELECTORS: { ... },
  DISABLED_CLASS: 'disabled',
  CACHE_TIMEOUT: 5000,
  DEBOUNCE_DELAY: 50
};

// 2. è¨­å®šç‹€æ…‹
let settings = {
  enabled: true,
  visualFeedback: true,
  customNextIds: [],
  customPrevIds: [],
  urlNavigation: true,
  urlParamName: 'page',
  hrefScan: true,
  loadMore: true
};

// 3. æŒ‰éˆ•å¿«å–
let buttonCache = {
  next: null,
  previous: null,
  lastUpdate: 0
};
```

#### æ ¸å¿ƒå‡½æ•¸

##### ç¬¬ 1 å±¤ï¼šæŒ‰éˆ•å°èˆª

```javascript
/**
 * æŸ¥æ‰¾åˆ†é æŒ‰éˆ•ï¼ˆå¤šç­–ç•¥ï¼‰
 * @param {string} type - 'next' æˆ– 'previous'
 * @returns {HTMLElement|null}
 */
function findButton(type) {
  // ç­–ç•¥ 0: è‡ªè¨‚ ID
  // ç­–ç•¥ 1: é è¨­ ID
  // ç­–ç•¥ 2: Class é¸æ“‡å™¨
  // ç­–ç•¥ 3: Data å±¬æ€§
}

/**
 * é»æ“Šä¸‹ä¸€é æŒ‰éˆ•
 * åŒ…å«å››å±¤ç­–ç•¥çš„å®Œæ•´é‚è¼¯
 */
function clickNextButton() {
  // 1. å˜—è©¦æŒ‰éˆ•å°èˆª
  // 2. å˜—è©¦ URL åƒæ•¸å°èˆª
  // 3. å˜—è©¦é€£çµæƒæ
  // 4. å˜—è©¦ Load More
}

/**
 * é»æ“Šä¸Šä¸€é æŒ‰éˆ•
 */
function clickPreviousButton() {
  // é¡ä¼¼ clickNextButton
  // ä½†ä¸Šä¸€é ä¸ä½¿ç”¨ Load More
}
```

##### ç¬¬ 2 å±¤ï¼šURL åƒæ•¸å°èˆª

```javascript
/**
 * ç²å–ç•¶å‰ URL çš„é ç¢¼
 * @returns {number|null}
 */
function getCurrentPageNumber() {
  // è§£æ URL åƒæ•¸
  // è¿”å›é ç¢¼æˆ– null
}

/**
 * å°èˆªåˆ°æŒ‡å®šé ç¢¼
 * @param {number} pageNumber
 */
function navigateToPage(pageNumber) {
  // æ§‹å»ºæ–° URL
  // åŸ·è¡Œé é¢è·³è½‰
}

/**
 * å°èˆªåˆ°ä¸‹ä¸€é ï¼ˆURL æ–¹å¼ï¼‰
 * @returns {boolean} æ˜¯å¦æˆåŠŸ
 */
function navigateToNextPage() {
  // ç•¶å‰é  +1
  // è·³è½‰åˆ°æ–°é 
}

/**
 * å°èˆªåˆ°ä¸Šä¸€é ï¼ˆURL æ–¹å¼ï¼‰
 * @returns {boolean} æ˜¯å¦æˆåŠŸ
 */
function navigateToPreviousPage() {
  // ç•¶å‰é  -1
  // è·³è½‰åˆ°æ–°é 
}
```

##### ç¬¬ 3 å±¤ï¼šæ™ºèƒ½é€£çµæƒæ

```javascript
/**
 * å¾ URL å­—ä¸²æå–é ç¢¼
 * @param {string} url
 * @returns {number|null}
 */
function extractPageNumber(url) {
  // æ–¹æ³• 1: URL API
  // æ–¹æ³• 2: æ­£å‰‡è¡¨é”å¼
}

/**
 * æƒæé é¢ä¸­æ‰€æœ‰åŒ…å«é ç¢¼çš„é€£çµ
 * @returns {Array<{url, pageNumber, element, text}>}
 */
function scanPageLinks() {
  // ç²å–æ‰€æœ‰ <a> æ¨™ç±¤
  // éæ¿¾åŒ…å«é ç¢¼çš„é€£çµ
  // è½‰æ›ç‚ºçµ•å°è·¯å¾‘
}

/**
 * æŸ¥æ‰¾æŒ‡å®šé ç¢¼çš„é€£çµ
 * @param {number} targetPage
 * @returns {string|null}
 */
function findLinkByPageNumber(targetPage) {
  // æƒæé€£çµ
  // åŒ¹é…ç›®æ¨™é ç¢¼
}

/**
 * é€šéé€£çµå°èˆªåˆ°ä¸‹ä¸€é 
 * @returns {boolean}
 */
function navigateToNextPageByHref() {
  // æ¨æ–·ç•¶å‰é ç¢¼
  // æŸ¥æ‰¾ä¸‹ä¸€é é€£çµ
  // åŸ·è¡Œå°èˆª
}

/**
 * é€šéé€£çµå°èˆªåˆ°ä¸Šä¸€é 
 * @returns {boolean}
 */
function navigateToPreviousPageByHref() {
  // æ¨æ–·ç•¶å‰é ç¢¼
  // æŸ¥æ‰¾ä¸Šä¸€é é€£çµ
  // åŸ·è¡Œå°èˆª
}
```

##### ç¬¬ 4 å±¤ï¼šLoad More æŒ‰éˆ•æª¢æ¸¬

```javascript
/**
 * æƒæ Load More æŒ‰éˆ•ï¼ˆå¤šèªè¨€ã€å¤šç­–ç•¥ï¼‰
 * @returns {HTMLElement|null}
 */
function findLoadMoreButton() {
  // é—œéµå­—åˆ—è¡¨ï¼ˆ7+ ç¨®èªè¨€ï¼‰
  const loadMoreKeywords = [
    'load more', 'show more', 'view more',
    'è¼‰å…¥æ›´å¤š', 'é¡¯ç¤ºæ›´å¤š', 'æŸ¥çœ‹æ›´å¤š',
    'ã‚‚ã£ã¨è¦‹ã‚‹', 'ë” ë³´ê¸°',
    'ver mÃ¡s', 'voir plus', 'mehr laden'
  ];

  // ç­–ç•¥ 1: button å…ƒç´ 
  // ç­–ç•¥ 2: link å…ƒç´ 
  // ç­–ç•¥ 3: class/id æ¨¡å¼
}

/**
 * é»æ“Š Load More æŒ‰éˆ•
 * @returns {boolean}
 */
function clickLoadMoreButton() {
  // æŸ¥æ‰¾æŒ‰éˆ•
  // æ·»åŠ è¦–è¦ºå›é¥‹
  // åŸ·è¡Œé»æ“Š
}
```

##### è¼”åŠ©åŠŸèƒ½

```javascript
/**
 * æª¢æŸ¥å…ƒç´ æ˜¯å¦ç‚ºè¼¸å…¥é¡å‹
 * @param {HTMLElement} element
 * @returns {boolean}
 */
function isInputElement(element) {
  // æª¢æŸ¥ tag name
  // æª¢æŸ¥ contenteditable
}

/**
 * æ·»åŠ è¦–è¦ºå›é¥‹æ•ˆæœ
 * @param {HTMLElement} button
 */
function addVisualFeedback(button) {
  // æ·»åŠ  CSS class
  // 600ms å¾Œç§»é™¤
}

/**
 * æ›´æ–°æŒ‰éˆ•å¿«å–
 */
function updateButtonCache() {
  // æœå°‹æŒ‰éˆ•
  // æ›´æ–°å¿«å–
  // è¨˜éŒ„æ™‚é–“æˆ³
}

/**
 * æ¸…é™¤æŒ‰éˆ•å¿«å–
 */
function clearButtonCache() {
  // é‡ç½®å¿«å–
}
```

##### äº‹ä»¶è™•ç†

```javascript
/**
 * è™•ç†éµç›¤äº‹ä»¶ï¼ˆä¸»å…¥å£ï¼‰
 * @param {KeyboardEvent} event
 */
function handleKeyDown(event) {
  // æª¢æŸ¥æ“´å……åŠŸèƒ½æ˜¯å¦å•Ÿç”¨
  // æª¢æŸ¥ç„¦é»æ˜¯å¦åœ¨è¼¸å…¥æ¡†
  // è™•ç† ArrowLeft/ArrowRight
}

/**
 * è¨­å®š MutationObserver
 * ç›£è½ DOM è®ŠåŒ–ï¼Œè‡ªå‹•æ›´æ–°æŒ‰éˆ•å¿«å–
 */
function setupMutationObserver() {
  // è§€å¯Ÿ childList
  // è§€å¯Ÿ attributes
  // éæ¿¾åˆ†é ç›¸é—œè®ŠåŒ–
}

/**
 * è¨­å®šè¨Šæ¯ç›£è½å™¨
 * æ¥æ”¶ä¾†è‡ª popup çš„è¨­å®šæ›´æ–°
 */
function setupMessageListener() {
  // ç›£è½ updateSettings
  // ç›£è½ getStatus
  // ç›£è½ clearCache
}

/**
 * è¨­å®šå„²å­˜ç›£è½å™¨
 * å³æ™‚åŒæ­¥è¨­å®šè®Šæ›´
 */
function setupStorageListener() {
  // ç›£è½ enabled
  // ç›£è½ visualFeedback
  // ç›£è½ urlNavigation
  // ç›£è½ hrefScan
  // ç›£è½ loadMore
}
```

##### åˆå§‹åŒ–èˆ‡æ¸…ç†

```javascript
/**
 * åˆå§‹åŒ–æ“´å……åŠŸèƒ½
 */
async function init() {
  // è¼‰å…¥è¨­å®š
  // åˆå§‹åŒ–å¿«å–
  // è¨­å®š MutationObserver
  // æ·»åŠ äº‹ä»¶ç›£è½å™¨
  // è¨­å®šè¨Šæ¯ç›£è½å™¨
  // è¨­å®šå„²å­˜ç›£è½å™¨
}

/**
 * æ¸…ç†è³‡æº
 */
function cleanup() {
  // æ–·é–‹ MutationObserver
  // æ¸…é™¤è¨ˆæ™‚å™¨
  // æ¸…é™¤å¿«å–
}
```

### 2. Popup UI (popup.html & popup.js)

**è·è²¬**: æä¾›ä½¿ç”¨è€…è¨­å®šä»‹é¢

#### UI çµ„ä»¶

```html
<!-- ç‹€æ…‹æŒ‡ç¤º -->
<div class="status">
  <div class="status-dot active"></div>
  <span class="status-text">æ“´å……åŠŸèƒ½å·²å•Ÿç”¨</span>
</div>

<!-- ä¸»è¦è¨­å®š -->
<div class="setting-item">
  <div class="setting-header">
    <span class="setting-title">å•Ÿç”¨éµç›¤å°èˆª</span>
    <label class="toggle-switch">
      <input type="checkbox" id="enable-toggle" checked>
      <span class="slider"></span>
    </label>
  </div>
</div>

<!-- è¦–è¦ºå›é¥‹è¨­å®š -->
<div class="setting-item">...</div>

<!-- URL åƒæ•¸å°èˆªè¨­å®š -->
<div class="setting-item">...</div>

<!-- æ™ºèƒ½é€£çµæƒæè¨­å®š -->
<div class="setting-item">...</div>

<!-- Load More æª¢æ¸¬è¨­å®š -->
<div class="setting-item">...</div>

<!-- è‡ªè¨‚æŒ‰éˆ• ID è¨­å®š -->
<div class="setting-item">
  <textarea id="custom-next-ids"></textarea>
  <textarea id="custom-prev-ids"></textarea>
  <button id="save-custom-ids-btn">å„²å­˜è‡ªè¨‚ ID</button>
</div>
```

#### Popup é‚è¼¯

```javascript
// DOM å…ƒç´ å¼•ç”¨
const elements = {
  enableToggle: ...,
  visualFeedbackToggle: ...,
  urlNavigationToggle: ...,
  urlParamName: ...,
  hrefScanToggle: ...,
  loadMoreToggle: ...,
  customNextIds: ...,
  customPrevIds: ...,
  saveCustomIdsBtn: ...
};

// é è¨­è¨­å®š
const DEFAULT_SETTINGS = {
  enabled: true,
  visualFeedback: true,
  customNextIds: [],
  customPrevIds: [],
  urlNavigation: true,
  urlParamName: 'page',
  hrefScan: true,
  loadMore: true
};

/**
 * è¼‰å…¥è¨­å®š
 */
async function loadSettings() {
  const result = await chrome.storage.sync.get(DEFAULT_SETTINGS);
  // æ›´æ–° UI
}

/**
 * å„²å­˜è¨­å®š
 */
async function saveSettings(settings) {
  await chrome.storage.sync.set(settings);
  // é€šçŸ¥æ‰€æœ‰åˆ†é 
}

/**
 * é€šçŸ¥å…§å®¹è…³æœ¬æ›´æ–°è¨­å®š
 */
async function notifyContentScripts(settings) {
  const tabs = await chrome.tabs.query({});
  // ç™¼é€è¨Šæ¯åˆ°æ‰€æœ‰åˆ†é 
}

/**
 * æ›´æ–°ç‹€æ…‹é¡¯ç¤º
 */
function updateStatus(enabled) {
  // æ›´æ–°ç‹€æ…‹åœ–ç¤ºå’Œæ–‡å­—
}

/**
 * é¡¯ç¤ºé€šçŸ¥è¨Šæ¯
 */
function showNotification(message, type = 'success') {
  // é¡¯ç¤ºå½ˆå‡ºé€šçŸ¥
  // 3ç§’å¾Œè‡ªå‹•æ¶ˆå¤±
}

/**
 * å„²å­˜è‡ªè¨‚ ID
 */
async function saveCustomIds() {
  // è§£æ textarea å…§å®¹
  // å„²å­˜åˆ°è¨­å®š
}

/**
 * é‡ç½®è¨­å®š
 */
async function resetSettings() {
  // ç¢ºèªå°è©±æ¡†
  // æ¢å¾©é è¨­å€¼
}
```

### 3. Background Service Worker (background.js)

**è·è²¬**: ç®¡ç†æ“´å……åŠŸèƒ½çš„å…¨åŸŸç‹€æ…‹

```javascript
/**
 * ç›£è½æ“´å……åŠŸèƒ½å®‰è£äº‹ä»¶
 */
chrome.runtime.onInstalled.addListener((details) => {
  // é¦–æ¬¡å®‰è£
  if (details.reason === 'install') {
    // è¨­å®šé è¨­å€¼
  }
  // æ›´æ–°
  if (details.reason === 'update') {
    // é·ç§»èˆŠè¨­å®š
  }
});

/**
 * ç›£è½åœ–ç¤ºé»æ“Šäº‹ä»¶ï¼ˆå¯é¸ï¼‰
 */
chrome.action.onClicked.addListener((tab) => {
  // é–‹å•Ÿ popup æˆ–åŸ·è¡Œå‹•ä½œ
});
```

---

## è³‡æ–™æµèˆ‡é€šè¨Š

### 1. è¨­å®šåŒæ­¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      saveSettings()      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Popup   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ Chrome Storage   â”‚
â”‚   UI     â”‚                          â”‚      API         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                         â”‚
     â”‚ notifyContentScripts()                 â”‚
     â†“                                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      chrome.tabs.sendMessage    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Content  â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  All Tabs        â”‚
â”‚ Scripts  â”‚                                 â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      storage.onChanged          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†‘
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                è‡ªå‹•ç›£è½ä¸¦æ›´æ–°
```

### 2. å°èˆªåŸ·è¡Œæµç¨‹

```
ç”¨æˆ¶æŒ‰éµ
    â†“
handleKeyDown()
    â†“
æª¢æŸ¥ settings.enabled
    â†“
æª¢æŸ¥ isInputElement()
    â†“
clickNextButton() / clickPreviousButton()
    â†“
â”Œâ”€ ç¬¬ 1 å±¤: findButton()
â”‚  â”œâ”€ æˆåŠŸ â†’ button.click() â†’ âœ…
â”‚  â””â”€ å¤±æ•— â†“
â”œâ”€ ç¬¬ 2 å±¤: navigateToNextPage()
â”‚  â”œâ”€ æˆåŠŸ â†’ window.location.href = newUrl â†’ âœ…
â”‚  â””â”€ å¤±æ•— â†“
â”œâ”€ ç¬¬ 3 å±¤: navigateToNextPageByHref()
â”‚  â”œâ”€ æˆåŠŸ â†’ window.location.href = linkUrl â†’ âœ…
â”‚  â””â”€ å¤±æ•— â†“
â””â”€ ç¬¬ 4 å±¤: clickLoadMoreButton()
   â”œâ”€ æˆåŠŸ â†’ button.click() â†’ âœ…
   â””â”€ å¤±æ•— â†’ âŒ æ‰€æœ‰æ–¹æ³•å¤±æ•—
```

---

## API åƒè€ƒ

### Chrome Extension API ä½¿ç”¨

#### chrome.storage.sync

```javascript
// è®€å–
chrome.storage.sync.get(keys, callback);
chrome.storage.sync.get({ key: defaultValue });

// å¯«å…¥
chrome.storage.sync.set({ key: value });

// ç›£è½è®Šæ›´
chrome.storage.onChanged.addListener((changes, areaName) => {
  if (areaName === 'sync') {
    // è™•ç†è®Šæ›´
  }
});
```

#### chrome.runtime

```javascript
// ç™¼é€è¨Šæ¯
chrome.runtime.sendMessage({ action: 'updateSettings', settings: {...} });

// ç›£è½è¨Šæ¯
chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
  // è™•ç†è¨Šæ¯
  sendResponse({ received: true });
  return false; // æˆ– trueï¼ˆå¦‚æœç•°æ­¥ï¼‰
});
```

#### chrome.tabs

```javascript
// æŸ¥è©¢æ‰€æœ‰åˆ†é 
chrome.tabs.query({}, (tabs) => {
  tabs.forEach(tab => {
    // è™•ç†æ¯å€‹åˆ†é 
  });
});

// ç™¼é€è¨Šæ¯åˆ°åˆ†é 
chrome.tabs.sendMessage(tabId, message, (response) => {
  // è™•ç†å›æ‡‰
});
```

### å…§éƒ¨ API

#### å°èˆª API

```javascript
// ç¬¬ 1 å±¤ï¼šæŒ‰éˆ•å°èˆª
findButton(type: 'next' | 'previous'): HTMLElement | null
clickNextButton(): void
clickPreviousButton(): void

// ç¬¬ 2 å±¤ï¼šURL åƒæ•¸å°èˆª
getCurrentPageNumber(): number | null
navigateToPage(pageNumber: number): void
navigateToNextPage(): boolean
navigateToPreviousPage(): boolean

// ç¬¬ 3 å±¤ï¼šé€£çµæƒæ
extractPageNumber(url: string): number | null
scanPageLinks(): Array<{url, pageNumber, element, text}>
findLinkByPageNumber(targetPage: number): string | null
navigateToNextPageByHref(): boolean
navigateToPreviousPageByHref(): boolean

// ç¬¬ 4 å±¤ï¼šLoad More
findLoadMoreButton(): HTMLElement | null
clickLoadMoreButton(): boolean
```

#### å¿«å–ç®¡ç† API

```javascript
updateButtonCache(): void
clearButtonCache(): void
getCachedButton(type: 'next' | 'previous'): HTMLElement | null
```

#### å·¥å…·å‡½æ•¸ API

```javascript
isInputElement(element: HTMLElement): boolean
addVisualFeedback(button: HTMLElement): void
```

---

## æ€§èƒ½å„ªåŒ–ç­–ç•¥

### 1. æŒ‰éˆ•å¿«å–æ©Ÿåˆ¶

**å•é¡Œ**: æ¯æ¬¡æŒ‰éµéƒ½æœå°‹æŒ‰éˆ•æœƒå½±éŸ¿æ€§èƒ½

**è§£æ±ºæ–¹æ¡ˆ**:
```javascript
// å¿«å–çµæ§‹
let buttonCache = {
  next: null,        // å¿«å–çš„æŒ‰éˆ•å…ƒç´ 
  previous: null,
  lastUpdate: 0      // æœ€å¾Œæ›´æ–°æ™‚é–“æˆ³
};

// å¿«å–ç­–ç•¥
const CACHE_TIMEOUT = 5000; // 5ç§’éæœŸ

function getCachedButton(type) {
  const now = Date.now();

  // æª¢æŸ¥å¿«å–æ˜¯å¦éæœŸ
  if (now - buttonCache.lastUpdate > CACHE_TIMEOUT) {
    updateButtonCache();
  }

  // æª¢æŸ¥å¿«å–çš„å…ƒç´ æ˜¯å¦é‚„åœ¨ DOM ä¸­
  if (buttonCache[type] && !document.contains(buttonCache[type])) {
    updateButtonCache();
  }

  return buttonCache[type];
}
```

**æ•ˆæœ**:
- âœ… æ¸›å°‘ DOM æŸ¥è©¢æ¬¡æ•¸
- âœ… é™ä½ CPU ä½¿ç”¨ç‡
- âœ… æå‡éŸ¿æ‡‰é€Ÿåº¦

### 2. MutationObserver æ™ºèƒ½ç›£è½

**å•é¡Œ**: DOM è®ŠåŒ–æ™‚å¿«å–å¯èƒ½å¤±æ•ˆ

**è§£æ±ºæ–¹æ¡ˆ**:
```javascript
const mutationObserver = new MutationObserver((mutations) => {
  let shouldUpdateCache = false;

  for (const mutation of mutations) {
    // åªé—œæ³¨åˆ†é ç›¸é—œçš„è®ŠåŒ–
    if (isPaginationRelated(mutation)) {
      shouldUpdateCache = true;
      break;
    }
  }

  if (shouldUpdateCache) {
    clearButtonCache();
    updateButtonCache();
  }
});

mutationObserver.observe(document.body, {
  childList: true,
  subtree: true,
  attributes: true,
  attributeFilter: ['class', 'disabled', 'data-dt-idx']
});
```

**æ•ˆæœ**:
- âœ… è‡ªå‹•æª¢æ¸¬åˆ†é çµæ§‹è®ŠåŒ–
- âœ… åŠæ™‚æ›´æ–°å¿«å–
- âœ… éæ¿¾ç„¡é—œçš„ DOM è®ŠåŒ–

### 3. é˜²æŠ–è™•ç†

**å•é¡Œ**: å¿«é€Ÿé€£çºŒæŒ‰éµå¯èƒ½å°è‡´é‡è¤‡åŸ·è¡Œ

**è§£æ±ºæ–¹æ¡ˆ**:
```javascript
let debounceTimer = null;
const DEBOUNCE_DELAY = 50; // 50ms

function handleKeyDownDebounced(event) {
  if (debounceTimer) {
    clearTimeout(debounceTimer);
  }

  debounceTimer = setTimeout(() => {
    handleKeyDownImmediate(event);
  }, DEBOUNCE_DELAY);
}
```

**æ³¨æ„**: ç›®å‰å¯¦ä½œä¸­ï¼Œæ–¹å‘éµç›´æ¥åŸ·è¡Œï¼ˆä¸ä½¿ç”¨é˜²æŠ–ï¼‰ï¼Œå› ç‚ºç”¨æˆ¶æœŸæœ›å³æ™‚éŸ¿æ‡‰ã€‚

### 4. é¸æ“‡å™¨å„ªåŒ–

**ç­–ç•¥ 1**: ä½¿ç”¨æœ€é«˜æ•ˆçš„é¸æ“‡å™¨
```javascript
// âœ… å„ªç§€ï¼šç›´æ¥ ID æŸ¥æ‰¾ï¼ˆæœ€å¿«ï¼‰
document.getElementById('table-list_next');

// âš ï¸ ä¸€èˆ¬ï¼šClass é¸æ“‡å™¨
document.querySelector('.paginate_button.next');

// âŒ é¿å…ï¼šè¤‡é›œçš„é¸æ“‡å™¨
document.querySelector('div > ul > li > a.next');
```

**ç­–ç•¥ 2**: æå‰è¿”å›
```javascript
function findButton(type) {
  // ç­–ç•¥ 0: è‡ªè¨‚ IDï¼ˆæœ€å¿«ï¼‰
  let button = findByCustomId(type);
  if (button) return button;  // ç«‹å³è¿”å›

  // ç­–ç•¥ 1: é è¨­ ID
  button = findByDefaultId(type);
  if (button) return button;  // ç«‹å³è¿”å›

  // ...ç¹¼çºŒå…¶ä»–ç­–ç•¥
}
```

### 5. è¨˜æ†¶é«”ç®¡ç†

**ç­–ç•¥ 1**: ä¸ç·©å­˜å¤§é‡è³‡æ–™
```javascript
// âŒ éŒ¯èª¤ï¼šç·©å­˜æ‰€æœ‰é€£çµ
let allLinksCache = document.querySelectorAll('a');

// âœ… æ­£ç¢ºï¼šæŒ‰éœ€æƒæ
function scanPageLinks() {
  const links = [];
  const allLinks = document.querySelectorAll('a[href]');
  // è™•ç†...
  return links; // å‡½æ•¸çµæŸå¾Œè‡ªå‹•é‡‹æ”¾
}
```

**ç­–ç•¥ 2**: åŠæ™‚æ¸…ç†
```javascript
window.addEventListener('beforeunload', () => {
  cleanup(); // é é¢å¸è¼‰æ™‚æ¸…ç†è³‡æº
});
```

---

## é–‹ç™¼å·¥ä½œæµ

### 1. ç’°å¢ƒè¨­ç½®

```bash
# å…‹éš†æˆ–å‰µå»ºå°ˆæ¡ˆ
mkdir anime-next
cd anime-next

# å‰µå»ºåŸºæœ¬çµæ§‹
mkdir icons styles test docs
touch manifest.json content.js background.js popup.html popup.js
```

### 2. é–‹ç™¼æµç¨‹

#### Phase 1: æ ¸å¿ƒåŠŸèƒ½é–‹ç™¼

1. **å»ºç«‹ manifest.json**
   ```json
   {
     "manifest_version": 3,
     "name": "Anime Next",
     "version": "1.0.0",
     "permissions": ["storage", "activeTab"],
     "content_scripts": [...],
     "action": { "default_popup": "popup.html" }
   }
   ```

2. **å¯¦ä½œ content.js**
   - âœ… åŸºç¤éµç›¤äº‹ä»¶ç›£è½
   - âœ… ç¬¬ 1 å±¤ï¼šæŒ‰éˆ•å°èˆª
   - âœ… è¼¸å…¥å…ƒç´ æª¢æ¸¬
   - âœ… æŒ‰éˆ•å¿«å–æ©Ÿåˆ¶

3. **å¯¦ä½œ popup UI**
   - âœ… åŸºæœ¬è¨­å®šä»‹é¢
   - âœ… é–‹é—œæ§åˆ¶
   - âœ… ç‹€æ…‹é¡¯ç¤º

#### Phase 2: é€²éšåŠŸèƒ½é–‹ç™¼

4. **ç¬¬ 2 å±¤ï¼šURL åƒæ•¸å°èˆª**
   - âœ… URL è§£æ
   - âœ… é ç¢¼æå–
   - âœ… URL æ§‹å»ºå’Œå°èˆª
   - âœ… è‡ªè¨‚åƒæ•¸åç¨±

5. **ç¬¬ 3 å±¤ï¼šæ™ºèƒ½é€£çµæƒæ**
   - âœ… é€£çµæƒæé‚è¼¯
   - âœ… é ç¢¼æå–æ¼”ç®—æ³•
   - âœ… ç•¶å‰é ç¢¼æ¨æ–·
   - âœ… é€£çµå°èˆª

6. **ç¬¬ 4 å±¤ï¼šLoad More æª¢æ¸¬**
   - âœ… å¤šèªè¨€é—œéµå­—æ”¯æ´
   - âœ… å¤šç­–ç•¥æª¢æ¸¬
   - âœ… æŒ‰éˆ•é»æ“Šé‚è¼¯

#### Phase 3: å„ªåŒ–èˆ‡å®Œå–„

7. **è¦–è¦ºå›é¥‹**
   - âœ… CSS å‹•ç•«æ•ˆæœ
   - âœ… å¯é¸é…ç½®

8. **è‡ªè¨‚åŠŸèƒ½**
   - âœ… è‡ªè¨‚æŒ‰éˆ• ID
   - âœ… è‡ªè¨‚ URL åƒæ•¸åç¨±
   - âœ… å„å±¤ç­–ç•¥é–‹é—œ

9. **MutationObserver**
   - âœ… DOM è®ŠåŒ–ç›£è½
   - âœ… æ™ºèƒ½å¿«å–æ›´æ–°

#### Phase 4: æ¸¬è©¦èˆ‡æ–‡ä»¶

10. **æ¸¬è©¦é é¢**
    - âœ… test-page.htmlï¼ˆåŸºæœ¬æ¸¬è©¦ï¼‰
    - âœ… custom-id-test.htmlï¼ˆè‡ªè¨‚ IDï¼‰
    - âœ… url-navigation-test.htmlï¼ˆURL å°èˆªï¼‰
    - âœ… href-scan-test.htmlï¼ˆé€£çµæƒæï¼‰
    - âœ… load-more-test.htmlï¼ˆLoad Moreï¼‰

11. **æ–‡ä»¶ç·¨å¯«**
    - âœ… README.md
    - âœ… INSTALL.md
    - âœ… TESTING.md
    - âœ… COMPATIBILITY.md
    - âœ… å„åŠŸèƒ½è©³ç´°æŒ‡å—

### 3. æ¸¬è©¦æ–¹æ³•

#### æœ¬åœ°æ¸¬è©¦

```bash
# Chrome/Edge
1. é–‹å•Ÿ chrome://extensions/ æˆ– edge://extensions/
2. å•Ÿç”¨ã€Œé–‹ç™¼äººå“¡æ¨¡å¼ã€
3. é»æ“Šã€Œè¼‰å…¥æœªå°è£é …ç›®ã€
4. é¸æ“‡å°ˆæ¡ˆè³‡æ–™å¤¾
5. é‡æ–°è¼‰å…¥æ“´å……åŠŸèƒ½ï¼ˆä¿®æ”¹å¾Œï¼‰
```

#### æ¸¬è©¦æ¡ˆä¾‹

```
âœ… åŸºæœ¬åŠŸèƒ½æ¸¬è©¦
   - åœ¨æœ‰åˆ†é çš„ç¶²é æŒ‰å·¦å³éµ
   - æª¢æŸ¥æŒ‰éˆ•æ˜¯å¦è¢«é»æ“Š

âœ… è¼¸å…¥å…ƒç´ æ¸¬è©¦
   - åœ¨è¼¸å…¥æ¡†ä¸­æŒ‰å·¦å³éµï¼ˆæ‡‰è©²ä¸è§¸ç™¼ï¼‰
   - åœ¨ textarea ä¸­æŒ‰å·¦å³éµï¼ˆæ‡‰è©²ä¸è§¸ç™¼ï¼‰

âœ… URL å°èˆªæ¸¬è©¦
   - åœ¨æœ‰ ?page=N çš„ç¶²é æ¸¬è©¦
   - æª¢æŸ¥ URL æ˜¯å¦æ­£ç¢ºè®ŠåŒ–

âœ… é€£çµæƒææ¸¬è©¦
   - åœ¨åªæœ‰é€£çµçš„åˆ†é ç¶²é æ¸¬è©¦
   - æª¢æŸ¥æ˜¯å¦æ­£ç¢ºå°èˆª

âœ… Load More æ¸¬è©¦
   - åœ¨ç„¡é™æ»¾å‹•ç¶²é æ¸¬è©¦
   - æª¢æŸ¥æ˜¯å¦è‡ªå‹•é»æ“Š Load More

âœ… å¿«å–æ¸¬è©¦
   - å‹•æ…‹æ·»åŠ /ç§»é™¤åˆ†é æŒ‰éˆ•
   - æª¢æŸ¥å¿«å–æ˜¯å¦æ­£ç¢ºæ›´æ–°

âœ… è¨­å®šåŒæ­¥æ¸¬è©¦
   - ä¿®æ”¹ popup è¨­å®š
   - æª¢æŸ¥æ˜¯å¦å³æ™‚ç”Ÿæ•ˆ
```

#### æ€§èƒ½æ¸¬è©¦

```javascript
// æ¸¬è©¦éŸ¿æ‡‰æ™‚é–“
console.time('navigation');
clickNextButton();
console.timeEnd('navigation'); // æ‡‰è©² < 100ms

// æ¸¬è©¦è¨˜æ†¶é«”ä½¿ç”¨
// Chrome DevTools > Memory > Take Snapshot
// æª¢æŸ¥æ˜¯å¦æœ‰è¨˜æ†¶é«”æ´©æ¼
```

### 4. èª¿è©¦æŠ€å·§

#### Console æ—¥èªŒ

```javascript
// åœ¨ content.js ä¸­å¤§é‡ä½¿ç”¨ console.log
console.log('[Anime Next] æ‰¾åˆ°æŒ‰éˆ•:', button);
console.log('[Anime Next] ç•¶å‰é ç¢¼:', currentPage);
console.log('[Anime Next] æƒæåˆ°é€£çµ:', links.length);
```

#### Chrome DevTools

```
1. Elements é¢æ¿
   - æª¢æŸ¥æŒ‰éˆ•å…ƒç´ çµæ§‹
   - æŸ¥çœ‹ CSS æ¨£å¼

2. Console é¢æ¿
   - æŸ¥çœ‹æ—¥èªŒè¼¸å‡º
   - æ‰‹å‹•åŸ·è¡Œå‡½æ•¸æ¸¬è©¦

3. Sources é¢æ¿
   - è¨­ç½®æ–·é»èª¿è©¦
   - é€æ­¥åŸ·è¡Œç¨‹å¼ç¢¼

4. Performance é¢æ¿
   - è¨˜éŒ„æ€§èƒ½æ•¸æ“š
   - åˆ†æç“¶é ¸

5. Memory é¢æ¿
   - æª¢æ¸¬è¨˜æ†¶é«”æ´©æ¼
   - åˆ†æè¨˜æ†¶é«”ä½¿ç”¨
```

---

## éƒ¨ç½²èˆ‡ç™¼å¸ƒ

### ç‰ˆæœ¬è¦åŠƒ

#### v1.0.0ï¼ˆç•¶å‰ç‰ˆæœ¬ï¼‰
- âœ… å››å±¤å®Œæ•´å°èˆªç­–ç•¥
- âœ… å¤šèªè¨€æ”¯æ´ï¼ˆ7+ ç¨®èªè¨€ï¼‰
- âœ… å®Œæ•´çš„è¨­å®šä»‹é¢
- âœ… è¦–è¦ºå›é¥‹æ•ˆæœ
- âœ… è‡ªè¨‚åŠŸèƒ½
- âœ… æ¸¬è©¦é é¢
- âœ… å®Œæ•´æ–‡ä»¶

#### v1.1.0ï¼ˆè¨ˆåŠƒä¸­ï¼‰
- â¬œ çµ±è¨ˆåŠŸèƒ½ï¼ˆä½¿ç”¨æ¬¡æ•¸ã€æˆåŠŸç‡ï¼‰
- â¬œ æ›´å¤šçš„è¦–è¦ºä¸»é¡Œ
- â¬œ å¿«æ·éµè‡ªè¨‚
- â¬œ åŒ¯å…¥/åŒ¯å‡ºè¨­å®š

#### v1.2.0ï¼ˆæœªä¾†ï¼‰
- â¬œ ç¶²ç«™ç™½åå–®/é»‘åå–®
- â¬œ æ™ºèƒ½å­¸ç¿’åŠŸèƒ½
- â¬œ é›²ç«¯åŒæ­¥è¨­å®š
- â¬œ å¤šç€è¦½å™¨æ”¯æ´ï¼ˆFirefoxï¼‰

### æ‰“åŒ…ç™¼å¸ƒ

#### æº–å‚™æ¸…å–®

```bash
âœ… æª¢æŸ¥ manifest.json ç‰ˆæœ¬è™Ÿ
âœ… æ›´æ–° README.md
âœ… æ›´æ–° CHANGELOG.md
âœ… æ¸¬è©¦æ‰€æœ‰åŠŸèƒ½
âœ… æª¢æŸ¥ console æ˜¯å¦æœ‰éŒ¯èª¤
âœ… æº–å‚™åœ–ç¤ºï¼ˆ16x16, 48x48, 128x128ï¼‰
âœ… æº–å‚™å®£å‚³åœ–ç‰‡ï¼ˆ1280x800 æˆ– 640x400ï¼‰
âœ… æ’°å¯«å•†åº—æè¿°
```

#### æ‰“åŒ…æ­¥é©Ÿ

```bash
# 1. æ¸…ç†é–‹ç™¼æª”æ¡ˆ
rm -rf .git
rm -rf node_modules
rm TODO.md

# 2. å‰µå»º ZIP æª”æ¡ˆ
zip -r anime-next-v1.0.0.zip . -x "*.git*" "node_modules/*" "*.DS_Store"

# 3. é©—è­‰ ZIP å…§å®¹
unzip -l anime-next-v1.0.0.zip
```

#### Chrome Web Store ç™¼å¸ƒ

```
1. å‰å¾€ Chrome Web Store Developer Dashboard
2. é»æ“Šã€Œæ–°å¢é …ç›®ã€
3. ä¸Šå‚³ ZIP æª”æ¡ˆ
4. å¡«å¯«å•†åº—è³‡è¨Š
   - åç¨±ï¼šAnime Next - éµç›¤å°èˆª
   - ç°¡çŸ­æè¿°ï¼šä½¿ç”¨éµç›¤æ–¹å‘éµè¼•é¬†å°èˆªç¶²é åˆ†é 
   - è©³ç´°æè¿°ï¼šï¼ˆåƒè€ƒ README.mdï¼‰
   - é¡åˆ¥ï¼šç”Ÿç”¢åŠ›
   - èªè¨€ï¼šä¸­æ–‡ï¼ˆç¹é«”ï¼‰ã€English
5. ä¸Šå‚³å®£å‚³åœ–ç‰‡å’Œæˆªåœ–
6. è¨­å®šéš±ç§æ¬Šæ”¿ç­–ï¼ˆå¦‚éœ€è¦ï¼‰
7. æäº¤å¯©æ ¸
```

#### Edge Add-ons ç™¼å¸ƒ

```
é¡ä¼¼ Chrome Web Storeï¼Œå‰å¾€ Microsoft Edge Add-ons
```

---

## æœ€ä½³å¯¦è¸

### ç¨‹å¼ç¢¼é¢¨æ ¼

```javascript
// 1. ä½¿ç”¨ ES6+ èªæ³•
const button = findButton('next');
const links = scanPageLinks();

// 2. æ˜ç¢ºçš„å‡½æ•¸å‘½å
function clickNextButton() { ... }  // âœ… æ¸…æ¥š
function next() { ... }             // âŒ ä¸æ¸…æ¥š

// 3. æ·»åŠ  JSDoc è¨»é‡‹
/**
 * æŸ¥æ‰¾åˆ†é æŒ‰éˆ•
 * @param {string} type - 'next' æˆ– 'previous'
 * @returns {HTMLElement|null} æ‰¾åˆ°çš„æŒ‰éˆ•æˆ– null
 */
function findButton(type) { ... }

// 4. éŒ¯èª¤è™•ç†
try {
  const result = await chrome.storage.sync.get(keys);
} catch (error) {
  console.error('[Anime Next] éŒ¯èª¤:', error);
}

// 5. å¸¸æ•¸ä½¿ç”¨å¤§å¯«
const CACHE_TIMEOUT = 5000;
const CONFIG = { ... };
```

### å®‰å…¨è€ƒé‡

```javascript
// 1. é¿å… eval()
// âŒ ä¸å®‰å…¨
eval(userInput);

// âœ… å®‰å…¨
const value = JSON.parse(safeString);

// 2. é©—è­‰ä½¿ç”¨è€…è¼¸å…¥
function saveCustomIds(input) {
  const ids = input
    .split('\n')
    .map(id => id.trim())
    .filter(id => id.length > 0 && id.length < 100); // é™åˆ¶é•·åº¦
}

// 3. ä½¿ç”¨ Content Security Policy
// manifest.json ä¸­å·²è¨­å®šé©ç•¶çš„ CSP

// 4. ä¸å„²å­˜æ•æ„Ÿè³‡è¨Š
// ä¸æ”¶é›†ä½¿ç”¨è€…çš„ç€è¦½æ­·å²æˆ–å€‹äººè³‡æ–™
```

### æ€§èƒ½è€ƒé‡

```javascript
// 1. é¿å…é »ç¹çš„ DOM æ“ä½œ
// âŒ ä½æ•ˆ
for (let i = 0; i < 1000; i++) {
  document.getElementById('list').innerHTML += '<li>item</li>';
}

// âœ… é«˜æ•ˆ
const html = [];
for (let i = 0; i < 1000; i++) {
  html.push('<li>item</li>');
}
document.getElementById('list').innerHTML = html.join('');

// 2. ä½¿ç”¨äº‹ä»¶å§”æ´¾
// âŒ æ¯å€‹æŒ‰éˆ•éƒ½ç¶å®šäº‹ä»¶
buttons.forEach(btn => btn.addEventListener('click', handler));

// âœ… åœ¨çˆ¶å…ƒç´ ä¸Šç¶å®šä¸€å€‹äº‹ä»¶
parent.addEventListener('click', (e) => {
  if (e.target.matches('button')) {
    handler(e);
  }
});

// 3. åŠæ™‚æ¸…ç†è³‡æº
window.addEventListener('beforeunload', cleanup);
```

---

## æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. æ“´å……åŠŸèƒ½ä¸å·¥ä½œ

**ç—‡ç‹€**: æŒ‰æ–¹å‘éµæ²’æœ‰åæ‡‰

**æ’æŸ¥æ­¥é©Ÿ**:
```
1. æª¢æŸ¥æ“´å……åŠŸèƒ½æ˜¯å¦å•Ÿç”¨
   - å‰å¾€ chrome://extensions/
   - ç¢ºèª Anime Next å·²å•Ÿç”¨

2. æª¢æŸ¥ popup è¨­å®š
   - é»æ“Šæ“´å……åŠŸèƒ½åœ–ç¤º
   - ç¢ºèªã€Œå•Ÿç”¨éµç›¤å°èˆªã€å·²é–‹å•Ÿ

3. æª¢æŸ¥ Console æ˜¯å¦æœ‰éŒ¯èª¤
   - æŒ‰ F12 é–‹å•Ÿ DevTools
   - æŸ¥çœ‹ Console é¢æ¿

4. é‡æ–°è¼‰å…¥æ“´å……åŠŸèƒ½
   - åœ¨æ“´å……åŠŸèƒ½é é¢é»æ“Šã€Œé‡æ–°è¼‰å…¥ã€
```

#### 2. æŒ‰éˆ•æ‰¾ä¸åˆ°

**ç—‡ç‹€**: Console é¡¯ç¤ºã€Œæ‰¾ä¸åˆ°æŒ‰éˆ•ã€

**æ’æŸ¥æ­¥é©Ÿ**:
```
1. æª¢æŸ¥æŒ‰éˆ•æ˜¯å¦å­˜åœ¨
   - åœ¨ DevTools Elements é¢æ¿æœå°‹æŒ‰éˆ•

2. æª¢æŸ¥æŒ‰éˆ•çš„ ID æˆ– class
   - ç¢ºèªæ˜¯å¦èˆ‡é è¨­é¸æ“‡å™¨åŒ¹é…

3. ä½¿ç”¨è‡ªè¨‚ ID åŠŸèƒ½
   - åœ¨ popup ä¸­æ·»åŠ æŒ‰éˆ•çš„å¯¦éš› ID

4. å˜—è©¦å…¶ä»–å°èˆªç­–ç•¥
   - å•Ÿç”¨ URL åƒæ•¸å°èˆª
   - å•Ÿç”¨é€£çµæƒæ
```

#### 3. URL å°èˆªä¸å·¥ä½œ

**ç—‡ç‹€**: URL æ²’æœ‰è®ŠåŒ–

**æ’æŸ¥æ­¥é©Ÿ**:
```
1. æª¢æŸ¥ URL æ ¼å¼
   - ç¢ºèª URL åŒ…å«é ç¢¼åƒæ•¸ï¼ˆå¦‚ ?page=3ï¼‰

2. æª¢æŸ¥åƒæ•¸åç¨±
   - åœ¨ popup ä¸­ç¢ºèªã€ŒURL åƒæ•¸åç¨±ã€è¨­å®šæ­£ç¢º

3. æª¢æŸ¥ Console æ—¥èªŒ
   - æŸ¥çœ‹æ˜¯å¦æœ‰ã€ŒURL ä¸­æ²’æœ‰æ‰¾åˆ°é ç¢¼åƒæ•¸ã€çš„è¨Šæ¯

4. å˜—è©¦æ‰‹å‹•ä¿®æ”¹ URL
   - ç¢ºèªç¶²ç«™æ”¯æ´ URL åƒæ•¸åˆ†é 
```

#### 4. Load More ä¸è§¸ç™¼

**ç—‡ç‹€**: ç„¡é™æ»¾å‹•ç¶²ç«™æ²’æœ‰è¼‰å…¥æ›´å¤š

**æ’æŸ¥æ­¥é©Ÿ**:
```
1. æª¢æŸ¥æŒ‰éˆ•æ–‡å­—
   - ç¢ºèªæŒ‰éˆ•æ–‡å­—åŒ…å«æ”¯æ´çš„é—œéµå­—

2. æª¢æŸ¥æŒ‰éˆ•å¯è¦‹æ€§
   - ç¢ºèªæŒ‰éˆ•æ²’æœ‰è¢« CSS éš±è—

3. æª¢æŸ¥ Console æ—¥èªŒ
   - æŸ¥çœ‹ã€Œæ‰¾åˆ° Load More æŒ‰éˆ•ã€æˆ–ã€Œæœªæ‰¾åˆ°ã€çš„è¨Šæ¯

4. æ‰‹å‹•æ¸¬è©¦æŒ‰éˆ•
   - ç”¨æ»‘é¼ é»æ“Šçœ‹æ˜¯å¦æ­£å¸¸å·¥ä½œ
```

### Debug æ¨¡å¼

åœ¨ content.js é–‹é ­æ·»åŠ ï¼š

```javascript
const DEBUG = true;

function log(...args) {
  if (DEBUG) {
    console.log('[Anime Next DEBUG]', ...args);
  }
}

// ä½¿ç”¨
log('ç•¶å‰é ç¢¼:', currentPage);
log('æ‰¾åˆ°çš„æŒ‰éˆ•:', button);
```

---

## è²¢ç»æŒ‡å—

### é–‹ç™¼ç’°å¢ƒè¦æ±‚

- Node.js: 16+ (å¦‚éœ€ä½¿ç”¨é–‹ç™¼å·¥å…·)
- Chrome/Edge: 88+
- Git: 2.0+
- ç·¨è¼¯å™¨: VS Code (æ¨è–¦)

### æäº¤è¦ç¯„

```bash
# Commit Message æ ¼å¼
<type>(<scope>): <subject>

# é¡å‹
feat: æ–°åŠŸèƒ½
fix: ä¿®å¾© bug
docs: æ–‡ä»¶æ›´æ–°
style: ç¨‹å¼ç¢¼æ ¼å¼
refactor: é‡æ§‹
test: æ¸¬è©¦ç›¸é—œ
chore: å…¶ä»–ä¿®æ”¹

# ç¯„ä¾‹
feat(navigation): æ–°å¢ Load More æŒ‰éˆ•æª¢æ¸¬
fix(cache): ä¿®å¾©æŒ‰éˆ•å¿«å–å¤±æ•ˆå•é¡Œ
docs(readme): æ›´æ–°å®‰è£èªªæ˜
```

### Pull Request æµç¨‹

```
1. Fork å°ˆæ¡ˆ
2. å‰µå»ºåŠŸèƒ½åˆ†æ”¯ (git checkout -b feature/AmazingFeature)
3. æäº¤è®Šæ›´ (git commit -m 'feat: Add amazing feature')
4. æ¨é€åˆ°åˆ†æ”¯ (git push origin feature/AmazingFeature)
5. é–‹å•Ÿ Pull Request
```

---

## æˆæ¬Šèˆ‡ç‰ˆæ¬Š

### æˆæ¬Šè³‡è¨Š
- **æˆæ¬Šé¡å‹**: MIT License
- **ç‰ˆæ¬Šæ‰€æœ‰**: Â© 2024 Anime Next Team

### ä½¿ç”¨é™åˆ¶
- âœ… å•†æ¥­ä½¿ç”¨
- âœ… ä¿®æ”¹
- âœ… åˆ†ç™¼
- âœ… ç§äººä½¿ç”¨

### è²¬ä»»è²æ˜
æœ¬æ“´å……åŠŸèƒ½æŒ‰ã€Œç¾ç‹€ã€æä¾›ï¼Œä¸æä¾›ä»»ä½•å½¢å¼çš„ä¿è­‰ã€‚

---

## è¯çµ¡è³‡è¨Š

### æ”¯æ´æ¸ é“
- **GitHub Issues**: å›å ± bug å’ŒåŠŸèƒ½è«‹æ±‚
- **GitHub Discussions**: ä¸€èˆ¬è¨è«–å’Œå•é¡Œ
- **Email**: ï¼ˆå¦‚æœ‰éœ€è¦å¯æ·»åŠ ï¼‰

### æœ‰ç”¨é€£çµ
- [Chrome Extension æ–‡ä»¶](https://developer.chrome.com/docs/extensions/)
- [MDN Web Docs](https://developer.mozilla.org/)
- [æ¸¬è©¦é é¢é›†åˆ](./test/)

---

## é™„éŒ„

### A. æ”¯æ´çš„ç¶²ç«™é¡å‹

```
âœ… DataTables è¡¨æ ¼
âœ… Bootstrap Pagination
âœ… jQuery UI Pagination
âœ… è‡ªè¨‚åˆ†é çµ„ä»¶
âœ… URL åƒæ•¸åˆ†é ç¶²ç«™
âœ… é€£çµå¼åˆ†é ç¶²ç«™
âœ… ç„¡é™æ»¾å‹•ç¶²ç«™
âœ… Load More æŒ‰éˆ•ç¶²ç«™
```

### B. ç€è¦½å™¨ç›¸å®¹æ€§

```
âœ… Chrome 88+
âœ… Edge 88+
â¬œ Firefox (è¨ˆåŠƒä¸­)
â¬œ Safari (è¨ˆåŠƒä¸­)
```

### C. é—œéµå­—æ”¯æ´åˆ—è¡¨

```javascript
// Load More é—œéµå­—ï¼ˆå®Œæ•´åˆ—è¡¨ï¼‰
const loadMoreKeywords = [
  // è‹±æ–‡
  'load more', 'load next', 'show more', 'view more',
  'see more', 'more', 'next page', 'load additional',

  // ä¸­æ–‡
  'è¼‰å…¥æ›´å¤š', 'æŸ¥çœ‹æ›´å¤š', 'é¡¯ç¤ºæ›´å¤š', 'æ›´å¤š', 'ä¸‹ä¸€é ',
  'åŠ è½½æ›´å¤š', 'æŸ¥çœ‹æ›´å¤š', 'æ˜¾ç¤ºæ›´å¤š', // ç°¡é«”

  // æ—¥æ–‡
  'ã‚‚ã£ã¨è¦‹ã‚‹', 'ã‚‚ã£ã¨èª­ã‚€', 'ç¶šãã‚’è¦‹ã‚‹',

  // éŸ“æ–‡
  'ë” ë³´ê¸°', 'ë”ë³´ê¸°', 'ë‹¤ìŒ',

  // è¥¿ç­ç‰™æ–‡
  'ver mÃ¡s', 'cargar mÃ¡s', 'mostrar mÃ¡s',

  // æ³•æ–‡
  'voir plus', 'charger plus', 'afficher plus',

  // å¾·æ–‡
  'mehr laden', 'mehr anzeigen', 'mehr sehen',

  // è‘¡è„ç‰™æ–‡
  'ver mais', 'carregar mais', 'mostrar mais'
];
```

### D. é¸æ“‡å™¨å„ªå…ˆç´š

```
å„ªå…ˆç´šï¼ˆå¾é«˜åˆ°ä½ï¼‰:

1. è‡ªè¨‚ IDï¼ˆç”¨æˆ¶é…ç½®ï¼‰
   document.getElementById(customId)

2. é è¨­ ID
   document.getElementById('table-list_next')

3. Class é¸æ“‡å™¨
   document.querySelector('.paginate_button.next')

4. Data å±¬æ€§
   document.querySelector('[data-dt-idx="next"]')

5. URL åƒæ•¸å°èˆª
   window.location.href = newUrl

6. é€£çµæƒæ
   æ‰¾åˆ°ä¸¦é»æ“ŠåŒ…å«é ç¢¼çš„é€£çµ

7. Load More æª¢æ¸¬
   æ‰¾åˆ°ä¸¦é»æ“Š Load More æŒ‰éˆ•
```

---

## ç‰ˆæœ¬æ­·å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¸»è¦è®Šæ›´ |
|------|------|----------|
| 1.0.0 | 2024-11-07 | åˆå§‹ç™¼å¸ƒ<br>- å››å±¤å°èˆªç­–ç•¥<br>- å¤šèªè¨€æ”¯æ´<br>- å®Œæ•´è¨­å®šä»‹é¢<br>- æ¸¬è©¦é é¢<br>- å®Œæ•´æ–‡ä»¶ |

---

**æœ€å¾Œæ›´æ–°**: 2024-11-07
**æ–‡ä»¶ç‰ˆæœ¬**: 1.0.0
**ç¶­è­·è€…**: Anime Next Development Team
